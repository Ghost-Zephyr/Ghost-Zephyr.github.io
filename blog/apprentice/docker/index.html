<!doctype html><html lang=en><head><meta charset=utf-8><meta name=robots content="index,follow"><title>Sivert Does Stuff Online! - Docker</title><meta name=description content="Introduction to Docker for local development and production deployment ready images."><link rel=icon href=/favicon.2a782c1d4fdbd387db5d712ee87bd8b01eb0cf56bd95198f4cc6a84ccf8bfb7e.png integrity='sha256-KngsHU/b04fbXXEu6HvYsB6wz1a9lRmPTMaoTM+L+34='><link rel=apple-touch-icon href=/favicon_hu5ee1517d9ee6726a25cfeec6a86e1947_41990_192x192_resize_box_3.3306e29c64ba856a2bd380475dcf6fcf81e835e05927358f6e225bbbdf44032a.png integrity='sha256-MwbinGS6hWor04BHXc9vz4HoNeBZJzWPbiJbu99EAyo='><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#00FF00"><meta name=twitter:card content="summary"><meta property="og:title" content="Sivert Does Stuff Online!"><meta property="og:url" content="https://io.sivert.pw"><meta property="og:site_name" content="Sivert Does Stuff Online!"><meta name=generator content="Hugo 0.101.0"><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.5.1/css/bootstrap.min.css crossorigin=anonymous><link href='/chroma.min.b7cbccb1554b70a7ffff2ffa00c8ce8e6cc8506a98c47088b8ec08515e93d4b9.css' integrity="sha256-t8vMsVVLcKf//y/6AMjOjmzIUGqYxHCIuOwIUV6T1Lk=" rel=stylesheet><link href='/main.min.f4d72690cb2c4e25d10d326f8ed68e54fbc469eb12a436d4d0461b54a9255371.css' integrity="sha256-9NcmkMssTiXRDTJvjtaOVPvEaesSpDbU0EYbVKklU3E=" rel=stylesheet></head><body><header><nav id=navbar><ul class=top-nav><li><a href=/>Sivert Does Stuff Online!</a></li><li><a href=/blog/apprentice><span>Apprentice docs</span></a></li><li id=right><ul><li><a href=https://sivert.pw><span>My Humble Homepage</span></a></li><li><a href=/old><span>Old GitHub.io</span></a></li><li><a href=/about><span>About</span></a></li><li><a href=/blog><span>Blog</span></a></li></ul></li></ul></nav></header><div id=content><main><div class=row><div class=col-md-2><aside id=meta><header><h4>Docker</h4><p>This article has 373 words.
2 minutes to read.</p></header><h6>Table of Contents:</h6><nav id=TableOfContents><ul><li><a href=#local-development>Local development</a><ul><li><a href=#simple-example>Simple example</a></li></ul></li><li><a href=#production-ready-images>Production ready images</a></li></ul></nav></aside></div><div class=col-md-10><article><header><h1>Docker</h1></header><p>Docker is a super container management system that lets you isolate programs and services.
This is very useful, both during development and for production deployment.
Because all dependencies may be bundled into the &ldquo;docker image&rdquo;.</p><p>And if the program/service is hacked.
The adversary will only have access to the container.
Which with proper configuration should make it super hard for any adversary to gain persistence.</p><h2 id=local-development>Local development</h2><p>When using docker for local development.
You&rsquo;d likely want to have a container that has all tools and dependencies for the project.
But not the project itself, because you&rsquo;d mount that into the container with the latest local changes.</p><p>So for example a simple project would just need a compiler or interpreter for the programming language.
And you should be good to go!
Although you&rsquo;d want to have auto-reloading or similar to automagically run or reload on code changes.</p><h3 id=simple-example>Simple example</h3><p>This is a simple docker setup for local development of a simple python web-app.</p><p>The Dockerfile; Dockerfile.local<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-docker data-lang=docker><span class=line><span class=cl><span class=k>FROM</span><span class=s> python:slim</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> ./requirements.txt .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> pip install -r ./requirements.txt<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;python&#34;</span><span class=p>,</span> <span class=s2>&#34;./run.py&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div></p><p>Build it;<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker build -t python-webapp Dockerfile.local</span></span></code></pre></td></tr></table></div></div>Run it;<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker run -v ./:/opt -itp 8080:80 python-webapp ./run.py</span></span></code></pre></td></tr></table></div></div></p><h2 id=production-ready-images>Production ready images</h2><p>For production on the other hand.
You want the application with the whole runtime within the docker image.
And you want it to be as standalone as possible for easy deployment in Kubernetes and the like.</p><p>The only real change needed to our simple python web-app example would be including the app in the docker image.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-docker data-lang=docker><span class=line><span class=cl><span class=k>FROM</span><span class=s> python:slim</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> ./ .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> pip install -r ./requirements.txt<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;python&#34;</span><span class=p>,</span> <span class=s2>&#34;./run.py&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></td></tr></table></div></div><p>The only difference from the local development version is the COPY of the entire project folder.
Instead of just the requirements.txt, if you have any sort of build step.
You&rsquo;d likely want to either just include the built application.
Or maybe even try docker multistep builds.</p><p>Doing so allows you to have one docker based build environment.
And a completely different one for the runtime that will become the actual docker image.
This is very good for many reasons, main one usually being minimal docker images.</p><p>For such advanced usage see <a href=../docker-fix target=_blank>docker-fix</a>.</p></article></div></div></main></div><footer><center><div class=footer-content><p>2020 - 2022 &copy; Sivert V. SÃ¦ther</p></div></center></footer></body></html>